#!/bin/bash

# kubctl-0x02 - Blue-green deployment strategy script

set -e

echo "ğŸš€ Applying blue deployment..."
kubectl apply -f blue_deployment.yaml

echo "ğŸš€ Applying green deployment..."
kubectl apply -f green_deployment.yaml

echo "ğŸ“„ Applying service routing to green deployment..."
kubectl apply -f kubeservice.yaml

echo "ğŸ” Checking logs of green pods..."
GREEN_PODS=$(kubectl get pods -l app=django,version=green -o name)

for pod in $GREEN_PODS; do
  echo "ğŸ“œ Logs for $pod:"
  kubectl logs "$pod"
  echo "-------------------------------"
done

echo "âœ… Blue-green deployment complete. Traffic is routed to GREEN version."
